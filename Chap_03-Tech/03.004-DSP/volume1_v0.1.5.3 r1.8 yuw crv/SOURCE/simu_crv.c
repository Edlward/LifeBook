/*****************************************************************************/
/*                                                                           */
/*     simu_crv.c                                                     		 */
/*                                                                         	 */
/*     Processing in a main loop                                			 */
/*                                                                         	 */
/*****************************************************************************/

/*------------ include files ------------------------------------------------*/
#include <stdio.h> 
#include <stdlib.h> 
#include <time.h> 
#include "calc_cpid.h" 

/*------------ debug define -------------------------------------------------*/
#define  DEBUG_CURVE_ENABLE  1

/*------------ MACRO define -------------------------------------------------*/
#define  NUM_CURVE_POINTS    300

/*------------ value define -------------------------------------------------*/
Uint16	g_uiaSampCloseCrv[NUM_CURVE_POINTS] = {
 0x00E0,0x008C,0x00E2,0x00CA,0x00EB,0x00E6,0x00F3,0x00F2,0x00F9,0x00F9,0x00FC,0x00FB,0x00FE,0x00FC,0x00FE,0x00FD,0x00FF,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE
,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x00FE,0x0154,0x0133,0x0154,0x014B,0x0158,0x0155,0x015A,0x015A,0x015C,0x015C
,0x015D,0x015E,0x015D,0x015F,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E,0x015E
};


/*---------------- 1: full close curve --------------------------------------*/
Uint16	g_uiaFullCloseCrv[NUM_CURVE_POINTS] = {
0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0076,	0x0076,	0x0077,	0x0077,	0x0078,\
0x0079,	0x0079,	0x007A,	0x007B,	0x007C,	0x007D,	0x007E,	0x007F,	0x0080,	0x0082,\
0x0083,	0x0084,	0x0086,	0x0087,	0x0089,	0x008A,	0x008C,	0x008E,	0x008F,	0x0091,\
0x0093,	0x0095,	0x0097,	0x0099,	0x009B,	0x009D,	0x009F,	0x00A1,	0x00A3,	0x00A5,\
0x00A7,	0x00A9,	0x00AC,	0x00AE,	0x00B0,	0x00B3,	0x00B5,	0x00B7,	0x00BA,	0x00BC,\
0x00BF,	0x00C1,	0x00C4,	0x00C6,	0x00C8,	0x00CB,	0x00CD,	0x00D0,	0x00D2,	0x00D5,\
0x00D7,	0x00DA,	0x00DC,	0x00DF,	0x00E1,	0x00E4,	0x00E6,	0x00E9,	0x00EB,	0x00ED,\
0x00F0,	0x00F2,	0x00F4,	0x00F7,	0x00F9,	0x00FB,	0x00FE,	0x0100,	0x0102,	0x0104,\
0x0106,	0x0108,	0x010A,	0x010C,	0x010E,	0x0110,	0x0112,	0x0114,	0x0115,	0x0117,\
0x0119,	0x011A,	0x011C,	0x011D,	0x011F,	0x0120,	0x0122,	0x0123,	0x0124,	0x0125,\
0x0126,	0x0127,	0x0128,	0x0129,	0x012A,	0x012B,	0x012C,	0x012C,	0x012D,	0x012D,\
0x012E,	0x012E,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,\
0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,\
0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,\
0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,	0x012F,\
0x012F,	0x012F,	0x012E,	0x012E,	0x012D,	0x012D,	0x012C,	0x012B,	0x012B,	0x012A,\
0x0129,	0x0128,	0x0127,	0x0126,	0x0125,	0x0124,	0x0122,	0x0121,	0x0120,	0x011E,\
0x011D,	0x011B,	0x011A,	0x0118,	0x0117,	0x0115,	0x0113,	0x0111,	0x010F,	0x010D,\
0x010C,	0x010A,	0x0108,	0x0105,	0x0103,	0x0101,	0x00FF,	0x00FD,	0x00FB,	0x00F8,\
0x00F6,	0x00F4,	0x00F1,	0x00EF,	0x00ED,	0x00EA,	0x00E8,	0x00E6,	0x00E3,	0x00E1,\
0x00DE,	0x00DC,	0x00D9,	0x00D7,	0x00D4,	0x00D2,	0x00CF,	0x00CD,	0x00CA,	0x00C8,\
0x00C5,	0x00C3,	0x00C0,	0x00BE,	0x00BB,	0x00B9,	0x00B7,	0x00B4,	0x00B2,	0x00B0,\
0x00AD,	0x00AB,	0x00A9,	0x00A7,	0x00A4,	0x00A2,	0x00A0,	0x009E,	0x009C,	0x009A,\
0x0098,	0x0096,	0x0094,	0x0092,	0x0091,	0x008F,	0x008D,	0x008B,	0x008A,	0x0088,\
0x0087,	0x0085,	0x0084,	0x0083,	0x0081,	0x0080,	0x007F,	0x007E,	0x007D,	0x007C,\
0x007B,	0x007A,	0x0079,	0x0078,	0x0078,	0x0077,	0x0077,	0x0076,	0x0076,	0x0075,\
0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,\
0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,\
0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,\
0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x0075,	0x000A,\
};

/*------------ Functions define ---------------------------------------------*/
void SimuCrvPidInit(void);

/*
 * ============================================================================
 *
 * FUNCTION: xxx.
 *
 * PARAMETERS: xxx.
 *
 * RETURN VALUE: xxx.
 * ============================================================================
 */
void SimuCurvePid(void)
{
	Uint16 cdelay = 0;
	Uint16 ccount = 0;
	int16  crrnt  = 0;

	int16  tmpSpeedSet = 0x0100;

	CrrntcPidInit();
	SimuCrvPidInit();

#if MCW_DEBUG_PRINTF
	printf("=== simu curve test begin \n");
#endif

	while (ccount < NUM_CURVE_POINTS)
	{

#if DEBUG_CURVE_ENABLE
		crrnt = AlgCrrntcPid(g_uiaFullCloseCrv[ccount]);
#else
		if (ccount < NUM_CURVE_POINTS/2)
		{
			tmpSpeedSet = 0x0100;
		}
		else
		{
			tmpSpeedSet = 0x0160;
		}
		crrnt = AlgCrrntcPid(tmpSpeedSet);
#endif

#if MCW_DEBUG_PRINTF
		printf("......................\n");
		printf("current=%d, counter=%d\n", crrnt,ccount);
#endif
		g_uiaSampCloseCrv[ccount] = crrnt;
		g_uiaSampCloseCrv[299] = 10;
		ccount++;
	}
//#if MCW_DEBUG_PRINTF
	printf("=== simu curve test end \n");
//#endif

    while (1)
    {
		cdelay ++;
    } /*while*/
}

/*
 * ============================================================================
 *
 * FUNCTION: xxx.
 *
 * PARAMETERS: xxx.
 *
 * RETURN VALUE: xxx.
 * ============================================================================
 */
void SimuCrvPidInit(void)
{
	Uint16 idx = 0;

	for (idx=0; idx<NUM_CURVE_POINTS; idx++)
	{
		g_uiaSampCloseCrv[idx] = 0;
	}
}

 /* ===========================================================================
 		file end
 ============================================================================*/

